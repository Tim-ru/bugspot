# BugSpot - Руководство по тестированию

## Автоматическое тестирование

### Полный Flow Test

Запустите скрипт для проверки всех критических функций:

```bash
# Убедитесь, что сервер запущен
npm run server

# В другом терминале запустите тест
node test-full-flow.js http://localhost:3001
```

Скрипт проверит:
- ✅ Health check API
- ✅ Регистрация пользователя
- ✅ Вход в систему
- ✅ Получение профиля
- ✅ Получение проектов
- ✅ Отправка баг-репорта
- ✅ Получение баг-репортов
- ✅ Обновление статуса

## Ручное тестирование

### Тестирование в браузерах

#### Chrome / Edge

1. Откройте DevTools (F12)
2. Перейдите в Console
3. Проверьте отсутствие ошибок JavaScript
4. Перейдите в Network tab
5. Проверьте запросы к API

#### Firefox

1. Откройте Developer Tools (F12)
2. Проверьте Console на ошибки
3. Проверьте Network monitor

#### Safari

1. Включите Develop menu: Preferences → Advanced → Show Develop menu
2. Откройте Web Inspector (Cmd+Option+I)
3. Проверьте Console и Network

### Тестирование виджета

#### Локальное тестирование

1. Соберите виджет:
   ```bash
   npm run build:widget
   ```

2. Создайте тестовую HTML страницу:
   ```html
   <!DOCTYPE html>
   <html>
   <head>
     <title>Widget Test</title>
   </head>
   <body>
     <h1>Test Page</h1>
     <script src="http://localhost:3001/widget.js"></script>
     <script>
       window.bugSpotConfig = {
         apiKey: 'YOUR_PROJECT_API_KEY',
         apiUrl: 'http://localhost:3001',
         position: 'bottom-right'
       };
     </script>
   </body>
   </html>
   ```

3. Откройте страницу в браузере
4. Проверьте:
   - Кнопка виджета появляется
   - Модальное окно открывается
   - Скриншот создается
   - Форма отправляется
   - Успешное сообщение показывается

### Тестирование на мобильных устройствах

#### iOS Safari

1. Запустите локальный сервер с доступом по сети:
   ```bash
   # Узнайте ваш IP адрес
   ifconfig | grep "inet "
   
   # Запустите сервер с доступом по сети
   # В vite.config.ts или используйте --host флаг
   ```

2. На iPhone/iPad откройте Safari
3. Перейдите на `http://YOUR_IP:3001`
4. Проверьте работу виджета:
   - Кнопка видна и кликабельна
   - Модальное окно открывается
   - Скриншот создается
   - Форма отправляется

#### Android Chrome

1. Аналогично iOS, используйте IP адрес вашего компьютера
2. Откройте Chrome на Android
3. Перейдите на `http://YOUR_IP:3001`
4. Проверьте работу виджета

### Тестирование Dashboard

#### Регистрация и вход

1. Откройте Dashboard
2. Зарегистрируйте нового пользователя
3. Войдите в систему
4. Проверьте:
   - Профиль загружается
   - API ключи видны
   - Проекты отображаются

#### Управление баг-репортами

1. Откройте раздел Bug Reports
2. Проверьте:
   - Список баг-репортов загружается
   - Фильтры работают
   - Поиск работает
   - Детали репорта открываются
   - Статус можно изменить
   - Репорты можно удалить

#### Экспорт данных

1. Нажмите "Export Data"
2. Проверьте:
   - JSON файл скачивается
   - Данные корректны
   - Все репорты включены

## Тестовые сценарии

### Сценарий 1: Полный цикл

1. ✅ Регистрация нового пользователя
2. ✅ Вход в систему
3. ✅ Получение Project API Key
4. ✅ Интеграция виджета на тестовую страницу
5. ✅ Отправка баг-репорта через виджет
6. ✅ Просмотр репорта в Dashboard
7. ✅ Изменение статуса
8. ✅ Экспорт данных

### Сценарий 2: Обработка ошибок

1. ✅ Отправка репорта с неверным API ключом
2. ✅ Отправка репорта без обязательных полей
3. ✅ Отправка репорта при недоступном API (fallback)
4. ✅ Просмотр репортов без авторизации

### Сценарий 3: Разные браузеры

1. ✅ Chrome (Desktop)
2. ✅ Firefox (Desktop)
3. ✅ Safari (Desktop)
4. ✅ Edge (Desktop)
5. ✅ Chrome Mobile (Android)
6. ✅ Safari Mobile (iOS)

### Сценарий 4: Производительность

1. ✅ Время загрузки виджета < 200ms
2. ✅ Размер виджета < 50KB gzipped
3. ✅ Время создания скриншота < 5s
4. ✅ Время ответа API < 200ms

## Чеклист перед запуском пилотов

- [ ] Все автоматические тесты проходят
- [ ] Виджет работает в Chrome
- [ ] Виджет работает в Firefox
- [ ] Виджет работает в Safari
- [ ] Виджет работает в Edge
- [ ] Виджет работает на iOS
- [ ] Виджет работает на Android
- [ ] Dashboard работает во всех браузерах
- [ ] Регистрация работает
- [ ] Вход работает
- [ ] Отправка баг-репортов работает
- [ ] Просмотр репортов работает
- [ ] Фильтры работают
- [ ] Экспорт работает
- [ ] Обработка ошибок работает
- [ ] Fallback на localStorage работает

## Отчет о тестировании

После тестирования заполните отчет:

```
Дата тестирования: ___________
Тестировщик: ___________

Браузеры:
- Chrome: ✅ / ❌
- Firefox: ✅ / ❌
- Safari: ✅ / ❌
- Edge: ✅ / ❌

Мобильные:
- iOS Safari: ✅ / ❌
- Android Chrome: ✅ / ❌

Функциональность:
- Регистрация: ✅ / ❌
- Вход: ✅ / ❌
- Виджет: ✅ / ❌
- Dashboard: ✅ / ❌
- API: ✅ / ❌

Найденные проблемы:
1. ___________
2. ___________
3. ___________
```

## Полезные команды

```bash
# Запуск тестового скрипта
node test-full-flow.js

# Проверка размера виджета
ls -lh widget/dist/widget.js
gzip -c widget/dist/widget.js | wc -c

# Проверка логов сервера
pm2 logs bugspot

# Проверка health endpoint
curl http://localhost:3001/api/health
```


